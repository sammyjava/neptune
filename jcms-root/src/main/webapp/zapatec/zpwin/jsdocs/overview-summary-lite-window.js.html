<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
Zapatec Window Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="lite-window.js Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b>Zapatec Window</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>lite-window.js</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		No overview generated for 'lite-window.js'<BR/><BR/>
	
</p>

<hr>



<!-- ========== METHOD SUMMARY =========== -->

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview"><span class="comment">// $Id: lite-window.js 15736 2009-02-06 15:29:25Z nikolai $</span>
<span class="comment">/**
 * The Zapatec DHTML Menu
 *
 * Copyright (c) 2004-2009 by Zapatec, Inc.
 * http://www.zapatec.com
 * 1700 MLK Way, Berkeley, California,
 * 94709, U.S.A.
 * All rights reserved.
 *
 * Windows Widget
 * $$
 *
 */</span>

<span class="comment">/**
 * The Window object constructor.  Call it, for example, like this:
 *
 * \code
 *   var win = new Zapatec.Window({
 *   	showResize : false
 *   });
 * \endcode
 *
 * The above creates a new Window object.  The Window isn't displayed
 * instantly; using the "win" variable, the programmer can now set certain
 * configuration variables, hook his own event handlers and then display the
 * window using Zapatec.Window.create() and Zapatec.Window.show().
 *
 * <span class="attrib">@param</span> config [object] - all parameters are passed as the properties of this object.
 * 
 * Constructor recognizes the following properties of the config object
 * \code
 *    prop. name     | description
 *  -------------------------------------------------------------------------------------------------
 *   showCloseButton | whether to show close button (default true).
 *   raiseOnlyOnTitle| whether to raize when clicking on title or on the whole body of the created window (default true).
 *   canDrag         | whether you can drag the window (default true).
 *   modal           | if true modal window will be created (default false).
 *   onClose         | custom handler, will be called when window is closed.
 *   onShow          | custom handler, will be called when show method is called.
 *   onHide          | custom handler, will be called when hide method is called.
 *   onRaize         | custom handler, will be called when window is raized.
 *   onContentLoad   | custom handler, will be called when content is loaded.
 *   
 * \endcode
 */</span>
Zapatec.Window = <span class="reserved">function</span> (config) {
	<span class="reserved">this</span>.winDiv = null;
	<span class="reserved">this</span>.titleArea = null;
	<span class="reserved">this</span>.titleText = null;
	<span class="reserved">this</span>.closeButton = null;
	<span class="reserved">this</span>.contentArea = null;	
	<span class="reserved">this</span>.winNumber = 0;
	<span class="reserved">this</span>.config = {};
	<span class="reserved">this</span>.config.showTitle = true;
	<span class="reserved">this</span>.config.titleWidth = 0;
	<span class="reserved">this</span>.config.contentWidth = 0;
	<span class="reserved">this</span>.config.heightDiff = 0;
	<span class="reserved">this</span>.config.left = 0;
	<span class="reserved">this</span>.config.top = 0;
	<span class="reserved">this</span>.config.width = 0;
	<span class="reserved">this</span>.config.height = 0;
	<span class="reserved">this</span>.config.minWidth = 180;
	<span class="reserved">this</span>.config.minHeight = 70;
	<span class="reserved">this</span>.setConfig(config);
};

<span class="comment">/**
 * \internal This function is called from the constructor, only once, to 
 * store only needed properties of the config object passed to the constructor.
 */</span>
Zapatec.Window.<span class="reserved">prototype</span>.setConfig = <span class="reserved">function</span> (config) {
	<span class="reserved">this</span>.config.showCloseButton = (typeof config.showCloseButton != <span class="literal">"undefined"</span>) ? config.showCloseButton : true;
	<span class="reserved">this</span>.config.raiseOnlyOnTitle = (typeof config.raiseOnlyOnTitle != <span class="literal">"undefined"</span>) ? config.raiseOnlyOnTitle : true;
	<span class="reserved">this</span>.config.canDrag = (typeof config.canDrag != <span class="literal">"undefined"</span>) ? config.canDrag : true;
	<span class="reserved">this</span>.config.modal = (typeof config.modal != <span class="literal">"undefined"</span>) ? config.modal : false;
	<span class="reserved">this</span>.config.onClose = (typeof config.onClose != <span class="literal">"undefined"</span>) ? config.onClose : null;
	<span class="reserved">this</span>.config.onShow = (typeof config.onShow != <span class="literal">"undefined"</span>) ? config.onShow : null;
	<span class="reserved">this</span>.config.onHide = (typeof config.onHide != <span class="literal">"undefined"</span>) ? config.onHide : null;
	<span class="reserved">this</span>.config.onRaise = (typeof config.onRaise != <span class="literal">"undefined"</span>) ? config.onRaise : null;
	<span class="reserved">this</span>.onContentLoad = (typeof config.onLoad != <span class="literal">"undefined"</span>) ? config.onLoad : <span class="reserved">function</span> () {};
};

<span class="comment">/**
 * This is a setup function for Window object.
 *
 * It gathers some mostly common routines when seting up the Window object on your page.
 * For example it creates the simple window and shows it, or creates the popup window.
 * Mostly in all cases (except popup window) it will be initialy shown. Possible enhancement
 * is to add a property to control the initial state of the window (including minimized, maximized, etc)
 *
 * <span class="attrib">@param</span> config [object] - all parameters are passed as the properties of this object. Many of them are 
 * the same as for the constructor.
 * 
 * Function recognizes the following properties of the config object (duplicated properties are listed in 
 * the constructor description so are not included here):
 * \code
 *    prop. name   | description
 *  -------------------------------------------------------------------------------------------------
 *   popup         | if it is set than window will be a popup window, triggered by the element you passed in this variable.
 *   triggerEvent  | if popup is set than this defines which event of the trigger element will force the window to popup. 
 *                 | Possible values: click, mousemove, mouseover, or any DOM event name.
 *   align         | align of the popup window relational to the trigger object. For information on values see the Zapatec.Window.prototype.showAtElement function description
 *   width         | initial width of the window in pixels.
 *   height        | initial height of the window in pixels.
 *   left          | initial X coordinate of the window.
 *   top           | initial Y coordinate of the window.
 *   title         | title of the window.
 *   content       | content of the window.
 *   divContent    | id of or "pointer" to the HTML element containing the content for the window.
 *   urlContent    | URL to load the content from.
 *   
 * \endcode
 */</span>
Zapatec.Window.setup = <span class="reserved">function</span> (config) {
	<span class="reserved">if</span> (!config) {config = {};}
	var win = new Zapatec.Window(config);
	win.create(config.left || 0, config.top || 0, config.width || win.config.minWidth, config.height || win.config.minHeight);
	<span class="reserved">if</span> (config.title) {
		win.setTitle(config.title);
	}
	<span class="reserved">if</span> (config.content) {
		win.setContent(config.content);
	}
	<span class="reserved">if</span> (config.divContent) {
     <span class="comment">// Save divContent config option for later use</span>
     win.config.divContent = config.divContent;
		win.setDivContent(config.divContent);
	}
	<span class="reserved">if</span> (config.urlContent) {
		win.setContentUrl(config.urlContent);
	}
	win.show();
	
	<span class="reserved">return</span> win;
}; 

<span class="comment">/**
 * A function that is called to handle mousedown event for our window.
 *
 * This function handles the routines that should be done on mousedown. Target parameter determines
 * whether something was "pushed" and holds that "pushed" element. "pushed" means that mouse was down
 * on that element and was not released. buttonType property of the target element determines the action that will be made.
 * There is one usefull possibility: if the target element has the customMouseDown property and it holds 
 * function, this function will be called except the default action.
 *
 * <span class="attrib">@param</span> ev [object] - event object.
 * <span class="attrib">@param</span> win [object] - our window object.
 * <span class="attrib">@param</span> target [object] - "pushed" element.
 */</span>
Zapatec.Window.mouseDown = <span class="reserved">function</span> (ev, win, target) {
	<span class="reserved">if</span> (!win.config.raiseOnlyOnTitle) {
		win.raise();
	} <span class="reserved">else</span> {
		<span class="reserved">if</span> (target &amp;&amp; ((target.buttonType == <span class="literal">"move"</span>) || (target.buttonType == <span class="literal">"min"</span>) || (target.buttonType == <span class="literal">"max"</span>) || (target.buttonType == <span class="literal">"close"</span>) || (target.buttonType == <span class="literal">"restore"</span>))) {
			win.raise();		
		}
	}
	<span class="reserved">if</span> (target) {
		switch (target.buttonType) {
			case <span class="literal">"move"</span> : {
				<span class="reserved">if</span> (!target.customMouseDown) {
					<span class="reserved">if</span> (win.config.canDrag &amp;&amp; win.config.state != <span class="literal">"min"</span> &amp;&amp; win.config.state != <span class="literal">"max"</span>) {
						var posX = ev.pageX || ev.clientX + window.document.body.scrollLeft || 0;
						var posY = ev.pageY || ev.clientY + window.document.body.scrollTop || 0;
						var L = parseInt(win.winDiv.style.left) || 0;
						var T = parseInt(win.winDiv.style.top) || 0;
						win.winDiv.xOffs = (posX - L);
						win.winDiv.yOffs = (posY - T);
						win.titleArea.style.cursor = <span class="literal">"move"</span>;
					}
				} <span class="reserved">else</span> {
					target.customMouseDown(ev, win, target);
				}
				break;
			}

			case <span class="literal">"close"</span> : {
				<span class="reserved">if</span> (!target.customMouseDown) {
				} <span class="reserved">else</span> {
					target.customMouseDown(ev, win, target);
				}
				break;
			}
		}
	}
}

<span class="comment">/**
 * A function that is called to handle mousemove event for our window.
 *
 * This function handles the routines that should be done on mousedown. Target parameter determines
 * whether something was "pushed" and holds that "pushed" element. "pushed" means that mouse was down
 * on that element and was not released. buttonType property of the target element determines the action that will be made.
 * There is one usefull possibility: if the target element has the customMouseMove property and it holds 
 * function, this function will be called except the default action.
 *
 * <span class="attrib">@param</span> ev [object] - event object.
 * <span class="attrib">@param</span> win [object] - our window object.
 * <span class="attrib">@param</span> target [object] - "pushed" element.
 */</span>
Zapatec.Window.mouseMove = <span class="reserved">function</span> (ev, win, target) {
	<span class="reserved">if</span> (target) {
		switch (target.buttonType) {
			case <span class="literal">"move"</span> : {
				<span class="reserved">if</span> (!target.customMouseMove) {
					<span class="reserved">if</span> (win.config.canDrag &amp;&amp; win.config.state != <span class="literal">"min"</span> &amp;&amp; win.config.state != <span class="literal">"max"</span>) {
						var posX = ev.pageX || ev.clientX + window.document.body.scrollLeft || 0;
						var posY = ev.pageY || ev.clientY + window.document.body.scrollTop || 0;
						var L = posX - win.winDiv.xOffs, T = posY - win.winDiv.yOffs;
						win.setPos(L, T);
					}
				} <span class="reserved">else</span> {
					target.customMouseMove(ev, win, target);
				}
				break;
			}
		}
	}
}

<span class="comment">/**
 * A function that is called to handle mouseup event for our window.
 *
 * This function handles the routines that should be done on mousedown. Target parameter determines
 * whether something was "pushed" and holds that "pushed" element. "pushed" means that mouse was down
 * on that element and was not released. buttonType property of the target element determines the action that will be made.
 * There is one usefull possibility: if the target element has the customMouseUp property and it holds 
 * function, this function will be called except the default action.
 *
 * <span class="attrib">@param</span> ev [object] - event object.
 * <span class="attrib">@param</span> win [object] - our window object.
 * <span class="attrib">@param</span> target [object] - "pushed" element.
 */</span>
Zapatec.Window.mouseUp = <span class="reserved">function</span> (ev, win, target, hi) {
	<span class="reserved">if</span> (target) {
		switch (target.buttonType) {
			case <span class="literal">"move"</span> : {
				<span class="reserved">if</span> (!target.customMouseUp) {
					<span class="reserved">if</span> (win.config.canDrag) {
						win.titleArea.style.cursor = <span class="literal">"default"</span>;
					}
				} <span class="reserved">else</span> {
					target.customMouseUp(ev, win, target);
				}
				break;
			}

			case <span class="literal">"close"</span> : {
				<span class="reserved">if</span> (!target.customMouseUp) {
					<span class="reserved">if</span> (target == (ev.srcElement || ev.target)) {
						win.close();
					}
				} <span class="reserved">else</span> {
					target.customMouseUp(ev, win, target);
				}
				break;
			}
		}
	}
}

<span class="comment">/**
 * This function assigns event handlers and implements "pushed" element finding.
 *
 * "Pushed" element finding is implemented the following way: all the event handlers see one
 * global variable target. When mouse is down on some element we try to get its buttonType property
 * or seek this property in elements parents. If the element with the buttonType is found it is put
 * into target variable. 
 */</span>
Zapatec.Window.<span class="reserved">prototype</span>.addEvents = <span class="reserved">function</span> () {
	var self = <span class="reserved">this</span>, target = null;
	Zapatec.Utils.addEvent(<span class="reserved">this</span>.winDiv, <span class="literal">"mousedown"</span>, <span class="reserved">function</span> (ev) {
		ev = ev || window.event; 
		target = Zapatec.Utils.getTargetElement(ev);
		<span class="reserved">while</span>(!target.buttonType &amp;&amp; (target != self.winDiv)) {
			target = target.parentNode;
		}
		<span class="reserved">if</span> (!target.buttonType) target = null;
		Zapatec.Window.mouseDown(ev, self, target);
		<span class="reserved">if</span> (target) <span class="reserved">return</span> Zapatec.Utils.stopEvent(ev);
	});
	Zapatec.Utils.addEvent(window.document, <span class="literal">"mousemove"</span>, <span class="reserved">function</span> (ev) {
		ev = ev || window.event; 
		Zapatec.Window.mouseMove(ev, self, target);
		<span class="reserved">if</span> (target) <span class="reserved">return</span> Zapatec.Utils.stopEvent(ev);
	});
	Zapatec.Utils.addEvent(window.document, <span class="literal">"mouseup"</span>, <span class="reserved">function</span> (ev) {
		ev = ev || window.event; 
		Zapatec.Window.mouseUp(ev, self, target);
		target = null;
		<span class="reserved">if</span> (target) <span class="reserved">return</span> Zapatec.Utils.stopEvent(ev);
	});
}

<span class="comment">/*
 * \internal
 * For internal use only. Calculates some sizes needed to implement title and status text cutting and content scrolling.
 */</span>
Zapatec.Window.<span class="reserved">prototype</span>.calculateSizes = <span class="reserved">function</span> () {
	<span class="reserved">this</span>.winDiv.style.display = <span class="literal">"block"</span>;
	<span class="reserved">if</span> (<span class="reserved">this</span>.titleArea) {
		<span class="comment">//Safari Fix</span>
		<span class="reserved">this</span>.config.titleWidth = <span class="reserved">this</span>.config.width - (<span class="reserved">this</span>.winDiv.offsetWidth - (Zapatec.is_khtml ? <span class="reserved">this</span>.titleText.firstChild.offsetWidth : <span class="reserved">this</span>.titleText.offsetWidth));
		<span class="comment">//Safari Fix</span>
		<span class="reserved">if</span> (Zapatec.is_khtml) <span class="reserved">this</span>.titleText.removeChild(<span class="reserved">this</span>.titleText.firstChild);
	}
	
	<span class="reserved">if</span> (<span class="reserved">this</span>.contentArea) {
		<span class="comment">//Safari Fix</span>
		<span class="reserved">this</span>.config.contentWidthDiff = <span class="reserved">this</span>.winDiv.offsetWidth - (Zapatec.is_khtml ? <span class="reserved">this</span>.contentArea.firstChild.offsetWidth : <span class="reserved">this</span>.contentArea.offsetWidth);
		<span class="reserved">this</span>.config.contentWidth = <span class="reserved">this</span>.config.width - <span class="reserved">this</span>.config.contentWidthDiff;
		<span class="comment">//Safari Fix</span>
		<span class="reserved">if</span> (Zapatec.is_khtml) <span class="reserved">this</span>.contentArea.removeChild(<span class="reserved">this</span>.contentArea.firstChild);
	}
	
	<span class="reserved">this</span>.config.heightDiff = <span class="reserved">this</span>.winDiv.offsetHeight - <span class="reserved">this</span>.config.height;
	<span class="reserved">this</span>.winDiv.style.display = <span class="literal">"none"</span>;
}

<span class="comment">/**
 * Creates all HTML elements of the window. This function takes in account
 * this.config object, trough its properties you can disable the following elements:
 *  - The whole title (currently don't work) - this.showTitle property;
 *  - Any of 3 buttons (min, max, close) - this.show(Min|Max|Close)Button property;
 *  - The status area - this.showStatus property;
 *  - The resize icon - this.canResize property;
 * Also calls this.addEvents to assign event handlers to the main div and creates WCH 
 * (http://www.aplus.co.yu/WCH/).
 * This function defines the following properties for HTML elements, needed for event handlers:
 *  - buttonType - one of three buttons or resize icon;
 *
 * <span class="attrib">@param</span> x [integer] x coordinate.
 * <span class="attrib">@param</span> y [integer] y coordinate.
 * <span class="attrib">@param</span> width [integer] width of the window.
 * <span class="attrib">@param</span> height [integer] height of the window.v
 *
 * <span class="attrib">@return</span> [object] { x, y } containing the position.
 */</span>
Zapatec.Window.<span class="reserved">prototype</span>.create = <span class="reserved">function</span> (x, y, width, height)  {
	<span class="reserved">if</span> (width == <span class="literal">"auto"</span>) {
		<span class="reserved">this</span>.config.autoContentWidth = true;
	}
	<span class="reserved">if</span> (height == <span class="literal">"auto"</span>) {
		<span class="reserved">this</span>.config.autoContentHeight = true;
	}
	var noButtons = !(<span class="reserved">this</span>.config.showCloseButton);
	var config = <span class="reserved">this</span>.config;
	<span class="comment">//creating of the top level div to control the width and position of the window</span>
	var div = <span class="reserved">this</span>.winDiv = Zapatec.Utils.createElement(<span class="literal">"div"</span>, null, true);
	div.style.position = <span class="literal">"absolute"</span>;
	div.style.width = (<span class="reserved">this</span>.config.width = parseInt(width, 10) || <span class="reserved">this</span>.config.minWidth) + <span class="literal">"px"</span>;
	div.style.display = <span class="literal">"none"</span>;
	<span class="reserved">this</span>.config.visible = false;
	<span class="reserved">this</span>.addEvents();
	
	<span class="comment">//creating of another div with zpWin class</span>
	div = Zapatec.Utils.createElement(<span class="literal">"div"</span>, div, true);
	div.className = <span class="literal">"zpWin"</span>;
	
	<span class="comment">//table with all the elements</span>
	var table = Zapatec.Utils.createElement(<span class="literal">"table"</span>, div, true);
	table.border = 0;
	table.cellPadding = <span class="literal">"0"</span>;
	table.cellSpacing = <span class="literal">"0"</span>;
	
	var tbody = Zapatec.Utils.createElement(<span class="literal">"tbody"</span>, table, true);
	
	<span class="comment">//title area of the window</span>
	<span class="reserved">if</span> (config.showTitle == true) {
		var tr = <span class="reserved">this</span>.titleArea = Zapatec.Utils.createElement(<span class="literal">"tr"</span>, tbody);
		tr.buttonType = <span class="literal">"move"</span>;
		tr.className = <span class="literal">"zpWinTitleArea"</span>;
		
		<span class="comment">//additional cell for ronded borders in title</span>
		var td = Zapatec.Utils.createElement(<span class="literal">"td"</span>, tr);
		div = Zapatec.Utils.createElement(<span class="literal">"div"</span>, td);
		div.innerHTML = <span class="literal">"&amp;nbsp;"</span>;

		<span class="comment">//cell with title text</span>
		td = Zapatec.Utils.createElement(<span class="literal">"td"</span>, tr);
		td.style.width = <span class="literal">"100%"</span>;
		
		div = <span class="reserved">this</span>.titleText = Zapatec.Utils.createElement(<span class="literal">"div"</span>, td);
		div.className = <span class="literal">"zpWinTitleText"</span>;
		div.style.overflow = <span class="literal">"hidden"</span>;
		div.style.height = <span class="literal">"100%"</span>;
		<span class="comment">//Safari Fix</span>
		<span class="reserved">if</span> (Zapatec.is_khtml) div = Zapatec.Utils.createElement(<span class="literal">"div"</span>, div);
		div.appendChild(document.createTextNode(<span class="literal">""</span>));
			
		<span class="comment">//cell with close button</span>
		td = Zapatec.Utils.createElement(<span class="literal">"td"</span>, tr);
		
		<span class="reserved">if</span> (config.showCloseButton == true) {		
			div = <span class="reserved">this</span>.closeButton = Zapatec.Utils.createElement(<span class="literal">"div"</span>, td);
			div.style.overflow = <span class="literal">"hidden"</span>;
			div.buttonType = <span class="literal">"close"</span>;
			div.className = <span class="literal">"zpWinCloseButton"</span>;
		} <span class="reserved">else</span> <span class="reserved">if</span> (!Zapatec.is_ie &amp;&amp; noButtons) {
			<span class="comment">//a workaround for Gecko's behaviour(we need to create at least one button cell for the window to be shown correctly).</span>
			div = Zapatec.Utils.createElement(<span class="literal">"div"</span>, td);
			div.innerHTML = <span class="literal">"&amp;nbsp;"</span>;
		}
		tr.firstChild.id = <span class="literal">"titleFirstCell"</span>;
		tr.lastChild.id = <span class="literal">"titleLastCell"</span>;
	}
	
	<span class="comment">//creating content area</span>
	tr = Zapatec.Utils.createElement(<span class="literal">"tr"</span>, tbody, true);
		
	td = Zapatec.Utils.createElement(<span class="literal">"td"</span>, tr, true);
	td.colSpan = 5;
	td.id = <span class="literal">"contentCell"</span>;
		
	div = <span class="reserved">this</span>.contentArea = document.createElement(<span class="literal">"div"</span>);
	td.appendChild(div);
	div.style.height = (<span class="reserved">this</span>.config.height = parseInt(height, 10) || <span class="reserved">this</span>.config.minHeight) + <span class="literal">"px"</span>;
	div.style.overflow = <span class="literal">"auto"</span>;
	div.className = <span class="literal">"zpWinContent"</span>;
	<span class="comment">//Safari Fix</span>
	<span class="reserved">if</span> (Zapatec.is_khtml) div = Zapatec.Utils.createElement(<span class="literal">"div"</span>, div);
	div.appendChild(document.createTextNode(<span class="literal">""</span>));
		
	window.document.body.appendChild(<span class="reserved">this</span>.winDiv);
	<span class="comment">//Seting widths of title, content and status elements for IE to proceed overflows.</span>
	<span class="reserved">this</span>.calculateSizes();
	var size = Zapatec.Utils.getWindowSize(); 
	var br = {};
	<span class="reserved">if</span> (Zapatec.is_ie) {
		br.y = window.document.body.scrollTop;
		br.x = window.document.body.scrollLeft;
	} <span class="reserved">else</span> {
		br.y = window.scrollY || 0;
		br.x = window.scrollX || 0;
	}
 	<span class="reserved">if</span> (x == <span class="literal">'center'</span>) { 
 		<span class="reserved">if</span> (screen.width) { 
 			x = (size.width -  <span class="reserved">this</span>.config.width)/2 + br.x; 
 		} 
 	} 
 	<span class="reserved">if</span> (y == <span class="literal">'center'</span>) { 
 		<span class="reserved">if</span> (screen.height) { 
			y = (size.height - (<span class="reserved">this</span>.config.height + <span class="reserved">this</span>.config.heightDiff))/2 + br.y; 
 		} 
 	}
	<span class="reserved">this</span>.winDiv.style.left = (<span class="reserved">this</span>.config.left = x) + <span class="literal">"px"</span>;
	<span class="reserved">this</span>.winDiv.style.top = (<span class="reserved">this</span>.config.top = y) + <span class="literal">"px"</span>;
	<span class="reserved">if</span> (<span class="reserved">this</span>.titleText) <span class="reserved">this</span>.titleText.style.width = <span class="reserved">this</span>.config.titleWidth + <span class="literal">"px"</span>;
	<span class="reserved">if</span> (<span class="reserved">this</span>.contentArea) <span class="reserved">this</span>.contentArea.style.width = <span class="reserved">this</span>.config.contentWidth + <span class="literal">"px"</span>;
	
	<span class="comment">//Creating WCH</span>
	<span class="reserved">this</span>.WCH = Zapatec.Utils.createWCH();
	
	<span class="comment">//Activating window.</span>
	<span class="reserved">if</span> (<span class="reserved">this</span>.config.modal == true) {
		<span class="reserved">this</span>.modalLayer = Zapatec.Utils.createElement(<span class="literal">"DIV"</span>, document.body);
		var st = <span class="reserved">this</span>.modalLayer.style;
		st.display = <span class="literal">"none"</span>;
		st.position = <span class="literal">"absolute"</span>;
		st.top = br.y + <span class="literal">"px"</span>;
		st.left = br.x + <span class="literal">"px"</span>;
		var dim = Zapatec.Utils.getWindowSize();
		st.width = dim.width + <span class="literal">"px"</span>;
		st.height = dim.height + <span class="literal">"px"</span>;
		st.zIndex = Zapatec.Window.maxNumber++;
		<span class="reserved">this</span>.modalLayer.className = <span class="literal">"zpWinModal"</span>;
		Zapatec.ScrollWithWindow.register(<span class="reserved">this</span>.modalLayer);
	}
	<span class="reserved">this</span>.setNumber();
	<span class="reserved">this</span>.winDiv.style.zIndex = Zapatec.Window.maxNumber;
	Zapatec.Window.winArray.push(<span class="reserved">this</span>);
	<span class="reserved">this</span>.setCurrent();
	<span class="comment">//alert(document.getElementById("1").innerHTML);</span>
	<span class="reserved">return</span> true;
}	

<span class="comment">// Global that holds the array of all the windows on the page</span>
Zapatec.Window.winArray = [];
<span class="comment">// Global that keeps track of max number of windows</span>
Zapatec.Window.maxNumber = 0;
<span class="comment">// Global that holds the pointer to the current window</span>
Zapatec.Window.currentWindow = null;
<span class="comment">// Global that keeps last active window</span>
Zapatec.Window.lastActive = null;

<span class="comment">/*
 * \internal
 * For internal use only.
 * Increment the max number of windows
 */</span>
Zapatec.Window.<span class="reserved">prototype</span>.setNumber = <span class="reserved">function</span>() {
	<span class="reserved">this</span>.winNumber = ++Zapatec.Window.maxNumber;
};

<span class="comment">/*
 * \internal
 * For internal use only.
 * Sets the current window
 */</span>

Zapatec.Window.<span class="reserved">prototype</span>.setCurrent = <span class="reserved">function</span>(deb) {
	var win = <span class="reserved">this</span>;
	<span class="reserved">if</span> (!win.winDiv) {
		<span class="reserved">return</span> false;
	}
	<span class="reserved">if</span> (Zapatec.Window.currentWindow &amp;&amp; <span class="comment">//if it is not the first one</span>
			win != Zapatec.Window.currentWindow) { <span class="comment">//and it is not the same one as before</span>
		<span class="comment">//Show the previous window as not being the current window anymore</span>
		<span class="reserved">if</span> (Zapatec.Window.currentWindow.winDiv) {
			Zapatec.Utils.removeClass(Zapatec.Window.currentWindow.winDiv, <span class="literal">'zpWinFront'</span>);
			Zapatec.Utils.addClass(Zapatec.Window.currentWindow.winDiv, <span class="literal">'zpWinBack'</span>);
		}
		<span class="reserved">if</span> (Zapatec.Window.currentWindow.winDiv) {
			Zapatec.Window.lastActive = Zapatec.Window.currentWindow;
		} 
	}
	<span class="comment">//And set the current window</span>
	Zapatec.Window.currentWindow = win;
	Zapatec.Utils.removeClass(win.winDiv, <span class="literal">'zpWinBack'</span>);
	Zapatec.Utils.addClass(win.winDiv, <span class="literal">'zpWinFront'</span>);
	<span class="reserved">return</span> true;
}

<span class="comment">/* 
 * Set the content of a window.
 * <span class="attrib">@param</span> type [string] the HTML data to set the content to.
 */</span>

Zapatec.Window.<span class="reserved">prototype</span>.setContent = <span class="reserved">function</span>(text) {
	<span class="reserved">if</span> (!<span class="reserved">this</span>.winDiv) {
		<span class="reserved">return</span> false;
	}
	<span class="reserved">if</span> (<span class="reserved">this</span>.config.autoContentWidth) {
		<span class="reserved">if</span> (<span class="reserved">this</span>.titleText) <span class="reserved">this</span>.titleText.style.width = <span class="literal">"auto"</span>;
		<span class="reserved">if</span> (<span class="reserved">this</span>.contentArea) {
			<span class="reserved">this</span>.contentArea.style.width = <span class="literal">"auto"</span>;
		}
		<span class="reserved">if</span> (<span class="reserved">this</span>.statusArea) <span class="reserved">this</span>.statusArea.style.width = <span class="literal">"auto"</span>;
		<span class="reserved">this</span>.contentArea.style.overflow = <span class="literal">"visible"</span>;
	}
	<span class="reserved">if</span> (<span class="reserved">this</span>.config.autoContentHeight) {
		<span class="reserved">if</span> (<span class="reserved">this</span>.contentArea) {
			<span class="reserved">this</span>.contentArea.style.height = <span class="literal">"auto"</span>;
		}
	}

	<span class="reserved">this</span>.contentArea.innerHTML = text;

	<span class="reserved">if</span> (<span class="reserved">this</span>.config.autoContentWidth || <span class="reserved">this</span>.config.autoContentHeight) {
		var shown = false;
		<span class="reserved">if</span> (<span class="reserved">this</span>.winDiv.style.display != <span class="literal">"block"</span>) {
			<span class="reserved">this</span>.show();
			shown = true;
		}
		<span class="reserved">if</span> (<span class="reserved">this</span>.config.autoContentWidth) <span class="reserved">this</span>.setWidth(<span class="reserved">this</span>.contentArea.offsetWidth + <span class="reserved">this</span>.config.contentWidthDiff);
		<span class="reserved">if</span> (<span class="reserved">this</span>.config.autoContentHeight) <span class="reserved">this</span>.setHeight(<span class="reserved">this</span>.contentArea.offsetHeight + (Zapatec.is_opera ? 4 : 0));
		<span class="reserved">this</span>.contentArea.style.overflow = <span class="literal">"auto"</span>;
		<span class="reserved">if</span> (shown) <span class="reserved">this</span>.hide();
	}
	<span class="reserved">return</span> true;
}

<span class="comment">/* 
 * Set the content of a window from HTML element(DIV).
 * <span class="attrib">@param</span> div [string]or [object] the HTML data to set the content to.
 */</span>

Zapatec.Window.<span class="reserved">prototype</span>.setDivContent = <span class="reserved">function</span>(div) {
	<span class="reserved">if</span> (!<span class="reserved">this</span>.winDiv) {
		<span class="reserved">return</span> false;
	}
	<span class="reserved">if</span> (typeof div == <span class="literal">"string"</span>) {
		div = document.getElementById(div);
	}
	<span class="reserved">if</span> (div &amp;&amp; <span class="reserved">this</span>.contentArea) {
		<span class="reserved">if</span> (<span class="reserved">this</span>.config.autoContentWidth) {
			<span class="reserved">if</span> (<span class="reserved">this</span>.titleText) <span class="reserved">this</span>.titleText.style.width = <span class="literal">"auto"</span>;
			<span class="reserved">if</span> (<span class="reserved">this</span>.contentArea) {
				<span class="reserved">this</span>.contentArea.style.width = <span class="literal">"auto"</span>;
			}
			<span class="reserved">if</span> (<span class="reserved">this</span>.statusArea) <span class="reserved">this</span>.statusArea.style.width = <span class="literal">"auto"</span>;
			<span class="reserved">this</span>.contentArea.style.overflow = <span class="literal">"visible"</span>;
		}
		<span class="reserved">if</span> (<span class="reserved">this</span>.config.autoContentHeight) {
			<span class="reserved">if</span> (<span class="reserved">this</span>.contentArea) {
				<span class="reserved">this</span>.contentArea.style.height = <span class="literal">"auto"</span>;
			}
		}

		var objChild = null;
	    <span class="comment">// Remove all previous window content</span>
	    objChild = <span class="reserved">this</span>.contentArea.firstChild;
	    <span class="reserved">while</span> (objChild) {
	      <span class="reserved">this</span>.contentArea.removeChild(objChild);
	      objChild = <span class="reserved">this</span>.contentArea.firstChild;
	    }
	    <span class="comment">// Move all children to the window</span>
	    objChild = div.firstChild;
	    <span class="reserved">while</span> (objChild) {
	      <span class="reserved">this</span>.contentArea.appendChild(objChild);
	      objChild = div.firstChild;
	    }

		<span class="reserved">if</span> (<span class="reserved">this</span>.config.autoContentWidth || <span class="reserved">this</span>.config.autoContentHeight) {
			var shown = false;
			<span class="reserved">if</span> (<span class="reserved">this</span>.winDiv.style.display != <span class="literal">"block"</span>) {
				<span class="reserved">this</span>.show();
				shown = true;
			}
			<span class="reserved">if</span> (<span class="reserved">this</span>.config.autoContentWidth) <span class="reserved">this</span>.setWidth(<span class="reserved">this</span>.contentArea.offsetWidth + <span class="reserved">this</span>.config.contentWidthDiff);
			<span class="reserved">if</span> (<span class="reserved">this</span>.config.autoContentHeight) <span class="reserved">this</span>.setHeight(<span class="reserved">this</span>.contentArea.offsetHeight + (Zapatec.is_opera ? 4 : 0));
			<span class="reserved">this</span>.contentArea.style.overflow = <span class="literal">"auto"</span>;
			<span class="reserved">if</span> (shown) <span class="reserved">this</span>.hide();
		}
	}
	<span class="reserved">return</span> true;
}

<span class="comment">/* 
 * Set the content of a window from url.
 * <span class="attrib">@param</span> div [string]or [object] the HTML data to set the content to.
 */</span>

Zapatec.Window.<span class="reserved">prototype</span>.setContentUrl = <span class="reserved">function</span>(url) {
	<span class="reserved">if</span> (!<span class="reserved">this</span>.winDiv) {
		<span class="reserved">return</span> false;
	}
	var self = <span class="reserved">this</span>;
	Zapatec.Transport.fetch({
		url : url, 
		onLoad : <span class="reserved">function</span> (result) {
			<span class="comment">//FIXED: &lt;script&gt;s didn't actually were executed on loaded piece of HTML, which I think was a problem</span>
			var text = result.responseText, script, scripts = [], attrs;
			<span class="reserved">while</span> (script = text.match(/&lt;script([^&gt;]*)&gt;([^&lt;]*)&lt;\/script&gt;/)) {
				text = text.replace(/&lt;script[^&gt;]*&gt;[^&lt;]*&lt;\/script&gt;/, <span class="literal">""</span>);
				scripts.push(script);
			}
			self.setContent(text);
			<span class="reserved">for</span>(i in scripts) {
				<span class="comment">// Evaluate code in global scope</span>
				setTimeout(scripts[i][2], 0);
			}
			self.onContentLoad();
		},
		onError : <span class="reserved">function</span> () {
			alert(<span class="literal">'Error while fetching data from the server'</span>);
		}
	});
	<span class="reserved">return</span> true;
}

<span class="comment">/*
 * Set the title of the window
 * <span class="attrib">@param</span> type [string] the title to set to
 */</span> 
Zapatec.Window.<span class="reserved">prototype</span>.setTitle = <span class="reserved">function</span>(text) {
	<span class="reserved">if</span> (!<span class="reserved">this</span>.winDiv) {
		<span class="reserved">return</span> false;
	}
	<span class="reserved">if</span> (text === <span class="literal">''</span>) {
		<span class="reserved">this</span>.titleText.innerHTML = <span class="literal">'Window '</span> + <span class="reserved">this</span>.winNumber;
	} <span class="reserved">else</span> {
		<span class="reserved">this</span>.titleText.innerHTML = text;
	}
	<span class="reserved">return</span> true;
}

<span class="comment">/**
 * Updates the window "WCH" (windowed controls hider).  A WCH is an
 * "invention" (read: "miserable hack") that works around one of the most
 * common and old bug in Internet Explorer: the SELECT boxes or IFRAMES show on
 * top of any other HTML element.  This function makes sure that the WCH covers
 * correctly the window element and another element if passed.
 */</span>
Zapatec.Window.<span class="reserved">prototype</span>.updateWCH = <span class="reserved">function</span>() {
	<span class="reserved">if</span> (<span class="reserved">this</span>.WCH &amp;&amp; <span class="reserved">this</span>.WCH.style.bottom != <span class="literal">""</span>) {
		<span class="reserved">this</span>.WCH.style.bottom = <span class="literal">""</span>;
	}
	Zapatec.Utils.setupWCH(<span class="reserved">this</span>.WCH, <span class="reserved">this</span>.config.left, <span class="reserved">this</span>.config.top, <span class="reserved">this</span>.config.width, <span class="reserved">this</span>.config.height + <span class="reserved">this</span>.config.heightDiff - 2);
	<span class="reserved">return</span> true;
}

<span class="comment">/**
 * Sets the X coordinate of the window. Needed to synchronize some variables in
 * one place. Also updates the WCH for IE.
 *
 * <span class="attrib">@param</span> left [integer] - X coordinate.
 */</span>
Zapatec.Window.<span class="reserved">prototype</span>.setLeft = <span class="reserved">function</span>(left) {
	<span class="reserved">if</span> (!<span class="reserved">this</span>.winDiv) {
		<span class="reserved">return</span> false;
	}
	(left &lt; 0) &amp;&amp; (left = 0);
	<span class="reserved">this</span>.winDiv.style.left = (<span class="reserved">this</span>.config.left = left) + <span class="literal">"px"</span>;
	<span class="reserved">this</span>.updateWCH();
	<span class="reserved">return</span> true;
}

<span class="comment">/**
 * Sets the Y coordinate of the window. Needed to synchronize some variables in
 * one place. Also updates the WCH for IE.
 *
 * <span class="attrib">@param</span> top [integer] - Y coordinate.
 */</span>
Zapatec.Window.<span class="reserved">prototype</span>.setTop = <span class="reserved">function</span>(top) {
	<span class="reserved">if</span> (!<span class="reserved">this</span>.winDiv) {
		<span class="reserved">return</span> false;
	}
	(top &lt; 0) &amp;&amp; (top = 0);
	<span class="reserved">this</span>.winDiv.style.top = (<span class="reserved">this</span>.config.top = top) + <span class="literal">"px"</span>;
	<span class="reserved">this</span>.updateWCH();
	<span class="reserved">return</span> true;
}

<span class="comment">/**
 * Sets the width of the window. Needed to synchronize some variables in
 * one place. Also updates the WCH for IE.
 *
 * <span class="attrib">@param</span> width [integer] - width of the window.
 */</span>
Zapatec.Window.<span class="reserved">prototype</span>.setWidth = <span class="reserved">function</span>(width) {
	<span class="reserved">if</span> (!<span class="reserved">this</span>.winDiv) {
		<span class="reserved">return</span> false;
	}
	var diff = <span class="reserved">this</span>.config.width - width;
	<span class="reserved">if</span> (Zapatec.is_gecko) {
	}
	<span class="reserved">this</span>.winDiv.style.width = (<span class="reserved">this</span>.config.width = width) + <span class="literal">"px"</span>;
	<span class="reserved">if</span> (<span class="reserved">this</span>.titleText) <span class="reserved">this</span>.titleText.style.width = (<span class="reserved">this</span>.config.titleWidth -= diff) + <span class="literal">"px"</span>;
	<span class="reserved">if</span> (<span class="reserved">this</span>.contentArea) <span class="reserved">this</span>.contentArea.style.width = (<span class="reserved">this</span>.config.contentWidth -= diff) + <span class="literal">"px"</span>;
	<span class="reserved">this</span>.updateWCH();
	<span class="reserved">return</span> true;
}

<span class="comment">/**
 * Sets the height of the window. Needed to synchronize some variables in
 * one place. Also updates the WCH for IE.
 *
 * <span class="attrib">@param</span> height [integer] - height of the window.
 */</span>
Zapatec.Window.<span class="reserved">prototype</span>.setHeight = <span class="reserved">function</span>(height) {
	<span class="reserved">if</span> (!<span class="reserved">this</span>.winDiv) {
		<span class="reserved">return</span> false;
	}
	<span class="reserved">this</span>.contentArea.style.height = (<span class="reserved">this</span>.config.height = height) + <span class="literal">"px"</span>;
	<span class="reserved">this</span>.updateWCH();
	<span class="reserved">return</span> true;
}

<span class="comment">/**
 * Sets the position of the window. 
 *
 * <span class="attrib">@param</span> left [integer] - X coordinate.
 * <span class="attrib">@param</span> top [integer] - Y coordinate.
 */</span>
Zapatec.Window.<span class="reserved">prototype</span>.setPos = <span class="reserved">function</span>(left, top) {
	<span class="reserved">if</span> (!<span class="reserved">this</span>.winDiv) {
		<span class="reserved">return</span> false;
	}
	<span class="reserved">this</span>.setLeft(left);
	<span class="reserved">this</span>.setTop(top);
	<span class="reserved">return</span> true;
}

<span class="comment">/**
 * Sets the sizes of the window. 
 *
 * <span class="attrib">@param</span> width [integer] - width of the window.
 * <span class="attrib">@param</span> height [integer] - height of the window.
 */</span>
Zapatec.Window.<span class="reserved">prototype</span>.setSize = <span class="reserved">function</span>(width, height) {
	<span class="reserved">if</span> (!<span class="reserved">this</span>.winDiv) {
		<span class="reserved">return</span> false;
	}
	<span class="reserved">this</span>.setWidth(width);
	<span class="reserved">this</span>.setHeight(height);
	<span class="reserved">return</span> true;
}


<span class="comment">/**
 * Sets the sizes and position of the window. 
 *
 * <span class="attrib">@param</span> left [integer] - X coordinate.
 * <span class="attrib">@param</span> top [integer] - Y coordinate.
 * <span class="attrib">@param</span> width [integer] - width of the window.
 * <span class="attrib">@param</span> height [integer] - height of the window.
 */</span>
Zapatec.Window.<span class="reserved">prototype</span>.setPosAndSize = <span class="reserved">function</span>(left, top, width, height) {
	<span class="reserved">if</span> (!<span class="reserved">this</span>.winDiv) {
		<span class="reserved">return</span> false;
	}
	<span class="reserved">this</span>.setPos(left, top);
	<span class="reserved">this</span>.setSize(width, height);
	<span class="reserved">return</span> true;
}

<span class="comment">/**
 * Raise this window so that it's above all other.
 * Bring it to the front.
 */</span> 
Zapatec.Window.<span class="reserved">prototype</span>.raise = <span class="reserved">function</span>() {
	<span class="reserved">if</span> (!<span class="reserved">this</span>.winDiv) {
		<span class="reserved">return</span> false;
	}
	Zapatec.Window.maxNumber++; <span class="comment">//increment so it's more than all the others</span>
	<span class="reserved">this</span>.winDiv.style.zIndex = Zapatec.Window.maxNumber;
	<span class="reserved">this</span>.setCurrent(<span class="reserved">this</span>);
	<span class="reserved">if</span> (<span class="reserved">this</span>.config.onRaise) {
		<span class="reserved">this</span>.config.onRaise(<span class="reserved">this</span>);
	}
	
	<span class="reserved">return</span> true;
}

<span class="comment">/**
 * Shows the window.
 */</span> 
Zapatec.Window.<span class="reserved">prototype</span>.show = <span class="reserved">function</span>() {
	<span class="reserved">if</span> (!<span class="reserved">this</span>.winDiv) {
		<span class="reserved">return</span> false;
	}
	<span class="reserved">this</span>.winDiv.style.display = <span class="literal">"block"</span>;
	<span class="reserved">if</span> (<span class="reserved">this</span>.config.modal == true &amp;&amp; <span class="reserved">this</span>.modalLayer) {
		<span class="reserved">this</span>.modalLayer.style.display = <span class="literal">"block"</span>;
	}
	<span class="reserved">this</span>.updateWCH();
	<span class="reserved">this</span>.config.visible = true;	
	<span class="reserved">if</span> (<span class="reserved">this</span>.config.onHide) {
		<span class="reserved">this</span>.config.onHide(<span class="reserved">this</span>);
	}
	<span class="reserved">return</span> true;
}

<span class="comment">/**
 * Hides the window.
 */</span> 
Zapatec.Window.<span class="reserved">prototype</span>.hide = <span class="reserved">function</span>() {
	<span class="reserved">if</span> (!<span class="reserved">this</span>.winDiv) {
		<span class="reserved">return</span> false;
	}
	<span class="reserved">this</span>.winDiv.style.display = <span class="literal">"none"</span>;
	<span class="reserved">if</span> (<span class="reserved">this</span>.config.modal == true &amp;&amp; <span class="reserved">this</span>.modalLayer) {
		<span class="reserved">this</span>.modalLayer.style.display = <span class="literal">"none"</span>;
	}
	Zapatec.Utils.hideWCH(<span class="reserved">this</span>.WCH);
	<span class="reserved">this</span>.config.visible = false;	
	<span class="reserved">if</span> (<span class="reserved">this</span>.config.onHide) {
		<span class="reserved">this</span>.config.onHide(<span class="reserved">this</span>);
	}
	<span class="reserved">return</span> true;
}

<span class="comment">/**
 * Closes the window. Currently does not destroys the window object, just the HTML part of it
 */</span> 
Zapatec.Window.<span class="reserved">prototype</span>.close = <span class="reserved">function</span>() {
  	<span class="reserved">if</span> (!<span class="reserved">this</span>.winDiv) {
		<span class="reserved">return</span> false;
	}
	<span class="comment">// Return content back to the place it was taken from</span>
  <span class="reserved">if</span> (<span class="reserved">this</span>.config.divContent &amp;&amp; <span class="reserved">this</span>.contentArea) {
    var objContent = null;
    <span class="reserved">if</span> (typeof <span class="reserved">this</span>.config.divContent == <span class="literal">'string'</span>) {
      objContent = document.getElementById(<span class="reserved">this</span>.config.divContent);
    } <span class="reserved">else</span> <span class="reserved">if</span> (typeof <span class="reserved">this</span>.config.divContent == <span class="literal">'object'</span>) {
      objContent = <span class="reserved">this</span>.config.divContent;
    }
    <span class="reserved">if</span> (objContent) {
      var objChild = <span class="reserved">this</span>.contentArea.firstChild;
      <span class="reserved">while</span> (objChild) {
        objContent.appendChild(objChild);
        objChild = <span class="reserved">this</span>.contentArea.firstChild;
      }
    }
  }
  <span class="comment">// Destroy window</span>
	Zapatec.Utils.destroy(<span class="reserved">this</span>.winDiv);
	Zapatec.Utils.destroy(<span class="reserved">this</span>.WCH);
	<span class="reserved">if</span> (<span class="reserved">this</span>.config.modal == true &amp;&amp; <span class="reserved">this</span>.modalLayer) {
		Zapatec.Utils.destroy(<span class="reserved">this</span>.modalLayer);
	}
	delete <span class="reserved">this</span>.winDiv;
	<span class="reserved">for</span> (i in Zapatec.Window.winArray) {
		<span class="reserved">if</span> (Zapatec.Window.winArray[i] == <span class="reserved">this</span>) {
			Zapatec.Window.winArray[i] = null;
		}
	}
	<span class="reserved">if</span> (Zapatec.Window.lastActive) {
		Zapatec.Window.lastActive.setCurrent();
	}
	<span class="reserved">if</span> (<span class="reserved">this</span>.config.onClose) {
		<span class="reserved">this</span>.config.onClose(<span class="reserved">this</span>);
	}
	<span class="reserved">return</span> true;
}

<span class="comment">/**
 * Destroy the window.
 */</span> 
Zapatec.Window.<span class="reserved">prototype</span>.destroy = <span class="reserved">function</span>() {
	<span class="reserved">this</span>.close();
}

<span class="comment">/**
 * This function displays the calendar near a given "anchor" element, according
 * to some rules passed in \em opts.  The \em opts argument is a string
 * containing one or 2 letters.  The first letter decides the vertical
 * alignment, and the second letter decides the horizontal alignment relative
 * to the anchor element.  Following we will describe these options; in parens
 * we will use simple descriptions like "top to bottom" which means that the
 * top margin of the calendar is aligned with the bottom margin of the object.
 *
 * \b Vertical align:
 *
 * - T -- the calendar is completely above the element (bottom to top)
 * - t -- the calendar is above the element but might overlap it (bottom to bottom)
 * - C -- the calendar is vertically centered to the element
 * - b -- the calendar is below the element but might overlap it (top to top)
 * - B -- the calendar is completely below the element (top to bottom)
 *
 * \b Horizontal align (defaults to 'l' if no letter passed):
 *
 * - L -- the calendar is completely to the left of the element (right to left)
 * - l -- the calendar is to the left of the element but might overlap it (right to right)
 * - C -- the calendar is horizontally centered to the element
 * - r -- the calendar is to the right of the element but might overlap it (left to left)
 * - R -- the calendar is completely to the right of the element (left to right)
 *
 * <span class="attrib">@param</span> el [HTMLElement] the anchor element
 * <span class="attrib">@param</span> opts [string, optional] the align options, as described above.  Defaults to "Bl" if nothing passed.
 */</span>
Zapatec.Window.<span class="reserved">prototype</span>.showAtElement = <span class="reserved">function</span> (el, opts) {
	<span class="reserved">if</span> (!<span class="reserved">this</span>.winDiv) {
		<span class="reserved">return</span> false;
	}
	var self = <span class="reserved">this</span>;
	var p = Zapatec.Utils.getAbsolutePos(el);
	<span class="reserved">if</span> (!opts || typeof opts != <span class="literal">"string"</span>) {
		<span class="reserved">this</span>.showAt(p.x, p.y + el.offsetHeight);
		<span class="reserved">return</span> true;
	}
	<span class="reserved">this</span>.winDiv.style.display = <span class="literal">"block"</span>;
	var w = self.winDiv.offsetWidth;
	var h = self.winDiv.offsetHeight;
	self.winDiv.style.display = <span class="literal">"none"</span>;
	var valign = opts.substr(0, 1);
	var halign = <span class="literal">"l"</span>;
	<span class="reserved">if</span> (opts.length &gt; 1) {
		halign = opts.substr(1, 1);
	}
	<span class="comment">// vertical alignment</span>
	switch (valign) {
	    case <span class="literal">"T"</span>: p.y -= h; break;
	    case <span class="literal">"B"</span>: p.y += el.offsetHeight; break;
	    case <span class="literal">"C"</span>: p.y += (el.offsetHeight - h) / 2; break;
	    case <span class="literal">"t"</span>: p.y += el.offsetHeight - h; break;
	    case <span class="literal">"b"</span>: break; <span class="comment">// already there</span>
	}
	<span class="comment">// horizontal alignment</span>
	switch (halign) {
	    case <span class="literal">"L"</span>: p.x -= w; break;
	    case <span class="literal">"R"</span>: p.x += el.offsetWidth; break;
	    case <span class="literal">"C"</span>: p.x += (el.offsetWidth - w) / 2; break;
	    case <span class="literal">"l"</span>: p.x += el.offsetWidth - w; break;
	    case <span class="literal">"r"</span>: break; <span class="comment">// already there</span>
	}
	p.width = w;
	p.height = h;
	Zapatec.Utils.fixBoxPosition(p);
	self.showAt(p.x, p.y);
	<span class="reserved">return</span> true;
}

<span class="comment">/**
 * Shows the calendar at a given absolute position (beware that, depending on
 * the calendar element style -- position property -- this might be relative to
 * the parent's containing rectangle).
 *
 * <span class="attrib">@param</span> x [int] the X position
 * <span class="attrib">@param</span> y [int] the Y position
 */</span>
Zapatec.Window.<span class="reserved">prototype</span>.showAt = <span class="reserved">function</span> (x, y) {
	<span class="reserved">if</span> (!<span class="reserved">this</span>.winDiv) {
		<span class="reserved">return</span> false;
	}
	<span class="reserved">this</span>.setPos(x, y);
	<span class="reserved">this</span>.show();
	<span class="reserved">return</span> true;
}

</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b>Zapatec Window</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">

</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Thu May 21 12:20:02 2009</div>
</body>
</html>
